<!DOCTYPE html>
<html lang="{{ language }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if language == 'es' %}Confirmaci√≥n de Pedido{% else %}Order Confirmation{% endif %}</title>
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f3f4f6;">
    <table role="presentation" style="width: 100%; border-collapse: collapse; background-color: #f3f4f6;">
        <tr>
            <td style="padding: 40px 20px;">
                <!-- Main Container -->
                <table role="presentation" style="max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">

                    <!-- Header with Logo -->
                    <tr>
                        <td style="background-color: #ffffff; padding: 40px 30px 30px; text-align: center;">
                            <img src="cid:logo" alt="Equus Pub" style="max-width: 140px; height: auto;">
                        </td>
                    </tr>

                    <!-- Orange Divider -->
                    <tr>
                        <td style="padding: 0;">
                            <div style="width: 100%; height: 4px; background: linear-gradient(135deg, #ff6b35 0%, #f97316 100%);"></div>
                        </td>
                    </tr>

                    <!-- Title -->
                    <tr>
                        <td style="padding: 30px 30px 20px; text-align: center;">
                            <h1 style="margin: 0; color: #ff6b35; font-size: 28px; font-weight: 700; line-height: 1.2;">
                                {% if language == 'es' %}
                                    ‚úì ¬°Pedido Confirmado!
                                {% else %}
                                    ‚úì Order Confirmed!
                                {% endif %}
                            </h1>
                        </td>
                    </tr>

                    <!-- Greeting -->
                    <tr>
                        <td style="padding: 0 30px 20px;">
                            <p style="margin: 0 0 16px; font-size: 18px; color: #111827; line-height: 1.5;">
                                {% if language == 'es' %}
                                    Hola <strong style="color: #ff6b35;">{{ user_name }}</strong>,
                                {% else %}
                                    Hello <strong style="color: #ff6b35;">{{ user_name }}</strong>,
                                {% endif %}
                            </p>
                            <p style="margin: 0; font-size: 16px; color: #6b7280; line-height: 1.6;">
                                {% if language == 'es' %}
                                    Gracias por tu pedido en <strong>Equus Pub</strong>. Hemos recibido tu orden. üçï
                                {% else %}
                                    Thank you for your order at <strong>Equus Pub</strong>. We have received your order. üçï
                                {% endif %}
                            </p>
                        </td>
                    </tr>

                    <!-- Order Info Card -->
                    <tr>
                        <td style="padding: 0 30px 30px;">
                            <table role="presentation" style="width: 100%; border-collapse: collapse; background-color: #fef3c7; border-left: 4px solid #ff6b35; border-radius: 8px;">
                                <tr>
                                    <td style="padding: 20px;">
                                        <h2 style="margin: 0 0 16px; color: #ff6b35; font-size: 20px; font-weight: 600;">
                                            {% if language == 'es' %}üìã Detalles del Pedido{% else %}üìã Order Details{% endif %}
                                        </h2>

                                        <!-- Order Number -->
                                        <table role="presentation" style="width: 100%; border-collapse: collapse;">
                                            <tr>
                                                <td style="padding: 8px 0; border-bottom: 1px solid #fde68a;">
                                                    <span style="font-weight: 600; color: #78350f;">
                                                        {% if language == 'es' %}Pedido #{% else %}Order #{% endif %}
                                                    </span>
                                                </td>
                                                <td style="padding: 8px 0; border-bottom: 1px solid #fde68a; text-align: right;">
                                                    <span style="color: #78350f;">{{ order_id }}</span>
                                                </td>
                                            </tr>

                                            <!-- Delivery Address -->
                                            <tr>
                                                <td style="padding: 8px 0; border-bottom: 1px solid #fde68a;">
                                                    <span style="font-weight: 600; color: #78350f;">
                                                        {% if language == 'es' %}üìç Direcci√≥n{% else %}üìç Address{% endif %}
                                                    </span>
                                                </td>
                                                <td style="padding: 8px 0; border-bottom: 1px solid #fde68a; text-align: right;">
                                                    <span style="color: #78350f;">
                                                        {{ delivery_street }}, {{ delivery_house_number }}<br>
                                                        {{ delivery_location }}
                                                    </span>
                                                </td>
                                            </tr>

                                            <!-- Phone -->
                                            <tr>
                                                <td style="padding: 8px 0; {% if notes %}border-bottom: 1px solid #fde68a;{% endif %}">
                                                    <span style="font-weight: 600; color: #78350f;">
                                                        {% if language == 'es' %}üì± Tel√©fono{% else %}üì± Phone{% endif %}
                                                    </span>
                                                </td>
                                                <td style="padding: 8px 0; {% if notes %}border-bottom: 1px solid #fde68a;{% endif %} text-align: right;">
                                                    <span style="color: #78350f;">{{ phone }}</span>
                                                </td>
                                            </tr>

                                            <!-- Notes (if any) -->
                                            {% if notes %}
                                            <tr>
                                                <td colspan="2" style="padding: 8px 0;">
                                                    <span style="font-weight: 600; color: #78350f;">
                                                        {% if language == 'es' %}üìù Notas:{% else %}üìù Notes:{% endif %}
                                                    </span><br>
                                                    <span style="color: #78350f; font-style: italic;">{{ notes }}</span>
                                                </td>
                                            </tr>
                                            {% endif %}
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- Products Title -->
                    <tr>
                        <td style="padding: 0 30px 20px;">
                            <h2 style="margin: 0; color: #111827; font-size: 22px; font-weight: 600;">
                                {% if language == 'es' %}üçΩÔ∏è Tu Pedido{% else %}üçΩÔ∏è Your Order{% endif %}
                            </h2>
                        </td>
                    </tr>

                    <!-- Product Items -->
                    {% for item in items %}
                    <tr>
                        <td style="padding: 0 30px 16px;">
                            <table role="presentation" style="width: 100%; border-collapse: collapse; background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                                <tr>
                                    <td style="padding: 16px;">
                                        <!-- Product Header -->
                                        <table role="presentation" style="width: 100%; border-collapse: collapse; margin-bottom: 8px;">
                                            <tr>
                                                <td>
                                                    <span style="font-size: 16px; font-weight: 600; color: #111827;">
                                                        {{ item.quantity }}x {{ item.name }}
                                                    </span>
                                                </td>
                                                <td style="text-align: right;">
                                                    <span style="font-size: 16px; font-weight: 700; color: #ff6b35;">
                                                        ‚Ç¨{{ item.subtotal|floatformat:2 }}
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>

                                        <!-- Unit Price -->
                                        <p style="margin: 0 0 8px; font-size: 14px; color: #6b7280;">
                                            {% if language == 'es' %}
                                                Precio unitario: <span style="font-weight: 500;">‚Ç¨{{ item.unit_price|floatformat:2 }}</span>
                                            {% else %}
                                                Unit price: <span style="font-weight: 500;">‚Ç¨{{ item.unit_price|floatformat:2 }}</span>
                                            {% endif %}
                                        </p>

                                        <!-- Customizations -->
                                        {% if item.customization %}
                                        <div style="background-color: #f9fafb; border-radius: 6px; padding: 12px; margin-top: 12px; font-size: 13px;">
                                            {% if item.customization.deselected_ingredients %}
                                            <p style="margin: 0 0 6px; color: #374151;">
                                                <span style="font-weight: 600; color: #dc2626;">‚ùå
                                                    {% if language == 'es' %}Sin:{% else %}Without:{% endif %}
                                                </span>
                                                {{ item.customization.deselected_ingredients|join:", " }}
                                            </p>
                                            {% endif %}

                                            {% if item.customization.selected_extras %}
                                            <p style="margin: 0 0 6px; color: #374151;">
                                                <span style="font-weight: 600; color: #ff6b35;">üåü
                                                    {% if language == 'es' %}Extras:{% else %}Extras:{% endif %}
                                                </span>
                                                {% for extra in item.customization.selected_extras %}
                                                    {{ extra.name }} (+‚Ç¨{{ extra.price|floatformat:2 }}){% if not forloop.last %}, {% endif %}
                                                {% endfor %}
                                            </p>
                                            {% endif %}

                                            {% if item.customization.additional_notes %}
                                            <p style="margin: 0; color: #374151;">
                                                <span style="font-weight: 600; color: #6366f1;">üìù
                                                    {% if language == 'es' %}Nota:{% else %}Note:{% endif %}
                                                </span>
                                                {{ item.customization.additional_notes }}
                                            </p>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    {% endfor %}

                    <!-- Total Section -->
                    <tr>
                        <td style="padding: 20px 30px 30px;">
                            <table role="presentation" style="width: 100%; border-collapse: collapse; background: linear-gradient(135deg, #ff6b35 0%, #f97316 100%); border-radius: 8px;">
                                <tr>
                                    <td style="padding: 24px; text-align: right;">
                                        <p style="margin: 0 0 8px; color: #ffffff; font-size: 16px; font-weight: 500; opacity: 0.9;">
                                            {% if language == 'es' %}Total a Pagar{% else %}Total Amount{% endif %}
                                        </p>
                                        <p style="margin: 0; color: #ffffff; font-size: 36px; font-weight: 700;">
                                            ‚Ç¨{{ total_price|floatformat:2 }}
                                        </p>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- Closing Message -->
                    <tr>
                        <td style="padding: 0 30px 30px;">
                            <p style="margin: 0; font-size: 15px; color: #6b7280; text-align: center; line-height: 1.6;">
                                {% if language == 'es' %}
                                    ¬°Muchas gracias por tu confianza! üôè<br>
                                    Pronto recibir√°s tu pedido.
                                {% else %}
                                    Thank you very much for your trust! üôè<br>
                                    You will receive your order soon.
                                {% endif %}
                            </p>
                        </td>
                    </tr>

                    <!-- Footer -->
                    <tr>
                        <td style="background-color: #1f2937; padding: 30px; text-align: center;">
                            <p style="margin: 0 0 12px; color: #ffffff; font-size: 16px; font-weight: 600;">
                                Equus Pub - Ardales
                            </p>
                            <p style="margin: 0 0 16px; font-size: 14px;">
                                <a href="https://www.facebook.com/equus.ardales" style="color: #ff6b35; text-decoration: none; margin: 0 8px;">Facebook</a>
                                <span style="color: #9ca3af;">|</span>
                                <a href="https://www.instagram.com/equuspubardales" style="color: #ff6b35; text-decoration: none; margin: 0 8px;">Instagram</a>
                            </p>
                            <p style="margin: 0; font-size: 12px; color: #9ca3af; line-height: 1.5;">
                                {% if language == 'es' %}
                                    Este es un email autom√°tico, por favor no respondas a este mensaje.
                                {% else %}
                                    This is an automated email, please do not reply to this message.
                                {% endif %}
                            </p>
                        </td>
                    </tr>

                </table>
            </td>
        </tr>
    </table>
</body>
</html>
